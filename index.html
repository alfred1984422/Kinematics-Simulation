<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜ä¸­ç‰©ç†è¿åŠ¨å­¦å®éªŒå®¤</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- MathJax é…ç½®å’Œå¼•å…¥ -->
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']]
  },
  chtml: { scale: 0.9 }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


    <script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        },
        startup: {
            ready: () => {
                console.log('MathJax is ready');
                MathJax.startup.defaultReady();
            }
        }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script" async></script>
    
    <style>
    /* æ ·å¼ä»£ç ä¿æŒä¸å˜ */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang SC", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        #main-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        #header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        #header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        #header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        #motion-selector {
            background: #f8f9fa;
            padding: 25px;
            border-bottom: 3px solid #667eea;
        }

        #motion-selector h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .motion-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
        }

        .motion-btn {
            padding: 15px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-size: 15px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .motion-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .motion-btn.active {
            background: #667eea;
            color: white;
        }

        #content-area {
            padding: 30px;
        }

        .theory-section {
            background: #e9f5ff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }

        .theory-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .theory-section ul {
            margin-left: 20px;
            line-height: 2;
        }

        .formula-box {
            background: white;
            padding: 20px;
            border-radius: 6px;
            margin: 15px 0;
            border: 1px solid #b3d7ff;
            font-size: 1.15em;
            line-height: 2.2;
        }

        .controls-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .controls-section h3 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 15px;
        }

        .control-group label {
            width: 180px;
            font-weight: bold;
            color: #555;
        }

        .control-group input[type="range"] {
            flex-grow: 1;
            cursor: pointer;
            height: 8px;
        }

        .control-group span {
            width: 100px;
            font-family: monospace;
            background: white;
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid #ddd;
            font-weight: bold;
            color: #667eea;
        }

        #animate-button {
            display: block;
            width: 100%;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
        }

        #animate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        #animate-button:disabled {
            background: #9e9e9e;
            cursor: not-allowed;
            transform: none;
        }

        .visualization-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .animation-box, .diagram-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .animation-box h3, .diagram-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        #animation-canvas, #diagram-canvas {
            width: 100%;
            height: 350px;
            background: #f5f5f5;
            border-radius: 6px;
            border: 1px solid #ddd;
        }

        .diagram-analysis {
            background: #fff9e6;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 3px solid #ffc107;
            font-size: 0.95em;
            line-height: 1.8;
        }

        .info-panel {
            background: #fff3cd;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #ffc107;
            margin-top: 15px;
        }

        .info-panel strong {
            color: #856404;
        }

        @media (max-width: 1024px) {
            .visualization-section {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            #header h1 {
                font-size: 1.8em;
            }
            
            .motion-buttons {
                grid-template-columns: 1fr;
            }
            
            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-group label {
                width: 100%;
            }
        }
    </style>
</head>
<body>

<div id="main-container">
    <div id="header">
        <h1>ğŸš€ é«˜ä¸­ç‰©ç†è¿åŠ¨å­¦å®éªŒå®¤</h1>
        <p>é€šè¿‡äº¤äº’å¼å¯è§†åŒ–,æ·±åº¦ç†è§£å…«å¤§è¿åŠ¨ç±»å‹çš„æœ¬è´¨ç‰¹å¾ä¸å…¬å¼ä½“ç³»</p>
    </div>

    <div id="motion-selector">
        <h2>é€‰æ‹©è¿åŠ¨ç±»å‹</h2>
        <div class="motion-buttons">
            <button class="motion-btn active" data-motion="uniform">åŒ€é€Ÿç›´çº¿è¿åŠ¨</button>
            <button class="motion-btn" data-motion="uniform-acc">åŒ€åŠ é€Ÿç›´çº¿è¿åŠ¨</button>
            <button class="motion-btn" data-motion="uniform-dec">åŒ€å‡é€Ÿç›´çº¿è¿åŠ¨</button>
            <button class="motion-btn" data-motion="freefall">è‡ªç”±è½ä½“è¿åŠ¨</button>
            <button class="motion-btn" data-motion="vertical-up">ç«–ç›´ä¸ŠæŠ›è¿åŠ¨</button>
            <button class="motion-btn" data-motion="horizontal">å¹³æŠ›è¿åŠ¨</button>
            <button class="motion-btn" data-motion="projectile">æ–œæŠ›è¿åŠ¨</button>
            <button class="motion-btn" data-motion="circular">åŒ€é€Ÿåœ†å‘¨è¿åŠ¨</button>
        </div>
    </div>

    <div id="content-area">
        <!-- åŠ¨æ€å†…å®¹å°†åœ¨è¿™é‡Œæ’å…¥ -->
    </div>
</div>

<script>
// è¿åŠ¨ç±»å‹æ•°æ®åº“
const motionData = {
    uniform: {
        title: "åŒ€é€Ÿç›´çº¿è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>åŠ é€Ÿåº¦:</strong> $a = 0$ (é€Ÿåº¦å¤§å°å’Œæ–¹å‘éƒ½ä¸å˜)</li>
                    <li><strong>è½¨è¿¹:</strong> ç›´çº¿,ä½ç§»ç­‰äºè·¯ç¨‹</li>
                    <li><strong>é€Ÿåº¦:</strong> æ’å®šä¸å˜</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    $$v = v_0$$ 
                    $$S = v_0 t$$
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>ä»»æ„ç›¸ç­‰æ—¶é—´å†…è·¯ç¨‹ç›¸ç­‰: $S_1 = S_2 = S_3 = \\cdots$</li>
                    <li>å¹³å‡é€Ÿåº¦ç­‰äºç¬æ—¶é€Ÿåº¦: $\\bar{v} = v_0$</li>
                    <li>$S$-$t$ å›¾åƒä¸ºè¿‡åŸç‚¹çš„ç›´çº¿,æ–œç‡ç­‰äºé€Ÿåº¦</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 'v0', label: 'é€Ÿåº¦ vâ‚€ (m/s)', min: -10, max: 10, step: 0.5, value: 5, unit: 'm/s'},
            {id: 't', label: 'æ—¶é—´ (s)', min: 1, max: 10, step: 0.5, value: 5, unit: 's'}
        ],
        diagramType: 'st',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> $S$-$t$ å›¾ä¸ºè¿‡åŸç‚¹çš„ç›´çº¿ã€‚æ–œç‡ $k = v_0$ è¡¨ç¤ºé€Ÿåº¦æ’å®šã€‚ç›´çº¿è¶Šé™¡,é€Ÿåº¦è¶Šå¤§ã€‚å›¾åƒç‰¹å¾:ç›´çº¿ã€æ–œç‡æ’å®šã€‚'
    },
    
    'uniform-acc': {
        title: "åŒ€åŠ é€Ÿç›´çº¿è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>åŠ é€Ÿåº¦:</strong> $a > 0$ ä¸”æ’å®š(ä¸é€Ÿåº¦æ–¹å‘ç›¸åŒ)</li>
                    <li><strong>é€Ÿåº¦å˜åŒ–:</strong> éšæ—¶é—´å‡åŒ€å¢å¤§</li>
                    <li><strong>è·¯ç¨‹å˜åŒ–:</strong> éšæ—¶é—´äºŒæ¬¡å¢å¤§(æŠ›ç‰©çº¿)</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    $$v = v_0 + at$$
                    $$S = v_0 t + \\frac{1}{2}at^2$$
                    $$v^2 - v_0^2 = 2aS$$
                    $$\\bar{v} = \\frac{v_0 + v}{2}$$
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>è¿ç»­ç›¸ç­‰æ—¶é—´è·¯ç¨‹å·®: $\\Delta S = aT^2$</li>
                    <li>ä¸­é—´æ—¶åˆ»é€Ÿåº¦: $v_{t/2} = \\frac{v_0 + v}{2} = \\bar{v}$</li>
                    <li>ä¸­é—´ä½ç½®é€Ÿåº¦: $v_{S/2} = \\sqrt{\\frac{v_0^2 + v^2}{2}}$</li>
                    <li>ä»»æ„æ—¶åˆ»é€Ÿåº¦å¢é‡: $\\Delta v = at$</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 'v0', label: 'åˆé€Ÿåº¦ vâ‚€ (m/s)', min: 0, max: 10, step: 0.5, value: 2, unit: 'm/s'},
            {id: 'a', label: 'åŠ é€Ÿåº¦ a (m/sÂ²)', min: 0.5, max: 5, step: 0.5, value: 2, unit: 'm/sÂ²'},
            {id: 't', label: 'æ—¶é—´ (s)', min: 1, max: 10, step: 0.5, value: 5, unit: 's'}
        ],
        diagramType: 'vt',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> $v$-$t$ å›¾ä¸ºå€¾æ–œç›´çº¿ã€‚æ–œç‡ $k = a > 0$ è¡¨ç¤ºåŠ é€Ÿåº¦æ’å®šã€‚å›¾çº¿ä¸ $t$ è½´å›´æˆçš„é¢ç§¯è¡¨ç¤ºè·¯ç¨‹ $S$ã€‚ç‰¹å¾:ç›´çº¿ä¸Šå‡ã€æ–œç‡ä¸ºæ­£ã€‚'
    },
    
    'uniform-dec': {
        title: "åŒ€å‡é€Ÿç›´çº¿è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>åŠ é€Ÿåº¦:</strong> $a < 0$ ä¸”æ’å®š(ä¸é€Ÿåº¦æ–¹å‘ç›¸å)</li>
                    <li><strong>é€Ÿåº¦å˜åŒ–:</strong> éšæ—¶é—´å‡åŒ€å‡å°,ç›´è‡³ä¸ºé›¶</li>
                    <li><strong>è·¯ç¨‹å˜åŒ–:</strong> å¢åŠ é€Ÿç‡é€æ¸å‡å°</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    $$v = v_0 - at \\quad (aå–æ­£å€¼)$$
                    $$S = v_0 t - \\frac{1}{2}at^2$$
                    $$v^2 - v_0^2 = -2aS$$
                    $$t_{åœ} = \\frac{v_0}{a}, \\quad S_{åœ} = \\frac{v_0^2}{2a}$$
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>è‹¥ç»™å®šæ—¶é—´ $t > t_{åœ}$,ç‰©ä½“åœ¨ $t_{åœ}$ æ—¶åˆ»å·²åœæ­¢</li>
                    <li>å®é™…è·¯ç¨‹å– $S = \\min\\left(v_0 t - \\frac{1}{2}at^2, S_{åœ}\\right)$</li>
                    <li>åˆ¹è½¦é—®é¢˜ä¸­å¿…é¡»å…ˆåˆ¤æ–­æ˜¯å¦åœæ­¢</li>
                    <li>è¿ç»­ç›¸ç­‰æ—¶é—´è·¯ç¨‹å·®: $|\\Delta S| = aT^2$</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 'v0', label: 'åˆé€Ÿåº¦ vâ‚€ (m/s)', min: 5, max: 20, step: 1, value: 10, unit: 'm/s'},
            {id: 'a', label: 'åŠ é€Ÿåº¦å¤§å° a (m/sÂ²)', min: 0.5, max: 5, step: 0.5, value: 2, unit: 'm/sÂ²'},
            {id: 't', label: 'æ—¶é—´ (s)', min: 1, max: 10, step: 0.5, value: 6, unit: 's'}
        ],
        diagramType: 'vt',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> $v$-$t$ å›¾ä¸ºä¸‹é™ç›´çº¿,æ–œç‡ $k = -a < 0$ã€‚ä¸ $t$ è½´äº¤ç‚¹ä¸ºåœæ­¢æ—¶åˆ»,ä¹‹åé€Ÿåº¦ä¿æŒä¸º 0ã€‚ç‰¹å¾:ç›´çº¿ä¸‹é™ã€ä¸æ¨ªè½´ç›¸äº¤ã€‚'
    },
    
    freefall: {
        title: "è‡ªç”±è½ä½“è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>å—åŠ›:</strong> åªå—é‡åŠ›ä½œç”¨</li>
                    <li><strong>åˆé€Ÿåº¦:</strong> $v_0 = 0$</li>
                    <li><strong>åŠ é€Ÿåº¦:</strong> $a = g = 9.8 \\text{ m/s}^2$ (ç«–ç›´å‘ä¸‹)</li>
                    <li><strong>è¿åŠ¨æ€§è´¨:</strong> åˆé€Ÿåº¦ä¸ºé›¶çš„åŒ€åŠ é€Ÿç›´çº¿è¿åŠ¨</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    $$v = gt$$
                    $$h = \\frac{1}{2}gt^2$$
                    $$v^2 = 2gh$$
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">(å‘ä¸‹ä¸ºæ­£æ–¹å‘)</div>
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>è¿ç»­ç›¸ç­‰æ—¶é—´å†…ä¸‹è½é«˜åº¦æ¯”: $h_1:h_2:h_3:\\cdots = 1:3:5:\\cdots$</li>
                    <li>é€šè¿‡è¿ç»­ç›¸ç­‰é«˜åº¦æ—¶é—´æ¯”: $t_1:t_2:t_3:\\cdots = 1:(\\sqrt{2}-1):(\\sqrt{3}-\\sqrt{2}):\\cdots$</li>
                    <li>ç¬¬ $n$ ç§’å†…ä¸‹è½é«˜åº¦: $h_n = \\frac{1}{2}g(2n-1)$</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 't', label: 'æ—¶é—´ (s)', min: 0.5, max: 5, step: 0.5, value: 3, unit: 's'}
        ],
        diagramType: 'ht',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> $h$-$t$ å›¾ä¸ºå¼€å£å‘ä¸‹çš„æŠ›ç‰©çº¿,èµ·ç‚¹åœ¨åŸç‚¹ã€‚æ›²çº¿æ–œç‡ä¸æ–­å¢å¤§,è¡¨ç¤ºé€Ÿåº¦ä¸æ–­å¢å¤§ã€‚ç‰¹å¾:äºŒæ¬¡å‡½æ•°ã€å¼€å£å‘ä¸‹ã€‚'
    },
    
    'vertical-up': {
        title: "ç«–ç›´ä¸ŠæŠ›è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>å—åŠ›:</strong> åªå—é‡åŠ›ä½œç”¨</li>
                    <li><strong>åˆé€Ÿåº¦:</strong> $v_0 > 0$ (ç«–ç›´å‘ä¸Š)</li>
                    <li><strong>åŠ é€Ÿåº¦:</strong> $a = -g = -9.8 \\text{ m/s}^2$ (å‘ä¸Šä¸ºæ­£)</li>
                    <li><strong>è¿åŠ¨è¿‡ç¨‹:</strong> å…ˆåŒ€å‡é€Ÿä¸Šå‡,ååŒ€åŠ é€Ÿä¸‹é™</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    $$v = v_0 - gt$$
                    $$h = v_0 t - \\frac{1}{2}gt^2$$
                    $$v^2 - v_0^2 = -2gh$$
                    <div style="font-size: 0.9em; color: #666; margin-top: 5px;">(å‘ä¸Šä¸ºæ­£æ–¹å‘)</div>
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>ä¸Šå‡åˆ°æœ€é«˜ç‚¹æ—¶é—´: $t_{ä¸Š} = \\frac{v_0}{g}$</li>
                    <li>æœ€å¤§é«˜åº¦: $H_{\\max} = \\frac{v_0^2}{2g}$</li>
                    <li>ä¸Šå‡æ—¶é—´ = ä¸‹é™æ—¶é—´: $t_{ä¸Š} = t_{ä¸‹}$</li>
                    <li>å›åˆ°æŠ›å‡ºç‚¹é€Ÿåº¦: $v = -v_0$ (å¤§å°ç›¸ç­‰,æ–¹å‘ç›¸å)</li>
                    <li>å¯¹ç§°æ€§: ä¸Šå‡è¿‡ç¨‹ä¸ä¸‹é™è¿‡ç¨‹å®Œå…¨å¯¹ç§°</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 'v0', label: 'åˆé€Ÿåº¦ vâ‚€ (m/s)', min: 5, max: 30, step: 1, value: 20, unit: 'm/s'},
            {id: 't', label: 'æ—¶é—´ (s)', min: 1, max: 8, step: 0.5, value: 5, unit: 's'}
        ],
        diagramType: 'ht',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> $h$-$t$ å›¾ä¸ºå¼€å£å‘ä¸‹çš„æŠ›ç‰©çº¿,å…ˆä¸Šå‡è‡³æœ€é«˜ç‚¹,åä¸‹é™ã€‚æœ€é«˜ç‚¹å¤„åˆ‡çº¿æ°´å¹³ $(v=0)$ã€‚å…³äºæœ€é«˜ç‚¹æ—¶åˆ»å¯¹ç§°ã€‚'
    },
    
    horizontal: {
        title: "å¹³æŠ›è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>å—åŠ›:</strong> åªå—é‡åŠ›,$a = g$ (ç«–ç›´å‘ä¸‹)</li>
                    <li><strong>åˆé€Ÿåº¦:</strong> $v_0$ æ°´å¹³æ–¹å‘</li>
                    <li><strong>è¿åŠ¨æ€§è´¨:</strong> åŒ€å˜é€Ÿæ›²çº¿è¿åŠ¨</li>
                    <li><strong>è½¨è¿¹:</strong> æŠ›ç‰©çº¿</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    <strong>æ°´å¹³æ–¹å‘(åŒ€é€Ÿ):</strong>
                    $$v_x = v_0, \\quad x = v_0 t$$
                    <strong>ç«–ç›´æ–¹å‘(è‡ªç”±è½ä½“):</strong>
                    $$v_y = gt, \\quad y = \\frac{1}{2}gt^2$$
                    <strong>åˆæˆ:</strong>
                    $$v = \\sqrt{v_0^2 + (gt)^2}$$
                    $$y = \\frac{gx^2}{2v_0^2}$$
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>é€Ÿåº¦åè§’: $\\tan\\alpha = \\frac{v_y}{v_x} = \\frac{gt}{v_0}$</li>
                    <li>ä½ç§»åè§’: $\\tan\\beta = \\frac{y}{x} = \\frac{gt}{2v_0}$</li>
                    <li>å…³ç³»: $\\tan\\alpha = 2\\tan\\beta$</li>
                    <li>é£è¡Œæ—¶é—´ç”±é«˜åº¦å†³å®š: $t = \\sqrt{\\frac{2h}{g}}$</li>
                    <li>æ°´å¹³å°„ç¨‹: $X = v_0\\sqrt{\\frac{2h}{g}}$</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 'v0', label: 'åˆé€Ÿåº¦ vâ‚€ (m/s)', min: 5, max: 30, step: 1, value: 15, unit: 'm/s'},
            {id: 'h', label: 'æŠ›å‡ºé«˜åº¦ (m)', min: 5, max: 50, step: 5, value: 20, unit: 'm'}
        ],
        diagramType: 'xy',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> è½¨è¿¹ä¸ºæŠ›ç‰©çº¿,å¼€å£å‘ä¸‹ã€‚æ°´å¹³æ–¹å‘åŒ€é€Ÿ,ç«–ç›´æ–¹å‘åŠ é€Ÿã€‚é€Ÿåº¦æ–¹å‘æ²¿åˆ‡çº¿æ–¹å‘,ä¸æ–­å˜åŒ–,ä¸æ°´å¹³å¤¹è§’å¢å¤§ã€‚'
    },
    
    projectile: {
        title: "æ–œæŠ›è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>å—åŠ›:</strong> åªå—é‡åŠ›,$a = g$ (ç«–ç›´å‘ä¸‹)</li>
                    <li><strong>åˆé€Ÿåº¦:</strong> $v_0$ ä¸æ°´å¹³æ–¹å‘æˆè§’åº¦ $\\theta$</li>
                    <li><strong>è¿åŠ¨æ€§è´¨:</strong> åŒ€å˜é€Ÿæ›²çº¿è¿åŠ¨</li>
                    <li><strong>è½¨è¿¹:</strong> æŠ›ç‰©çº¿(å¯¹ç§°)</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    <strong>æ°´å¹³æ–¹å‘(åŒ€é€Ÿ):</strong>
                    $$v_x = v_0\\cos\\theta, \\quad x = v_0\\cos\\theta \\cdot t$$
                    <strong>ç«–ç›´æ–¹å‘(ç«–ç›´ä¸ŠæŠ›):</strong>
                    $$v_y = v_0\\sin\\theta - gt$$
                    $$y = v_0\\sin\\theta \\cdot t - \\frac{1}{2}gt^2$$
                    <strong>ç‰¹å¾é‡:</strong>
                    $$H = \\frac{(v_0\\sin\\theta)^2}{2g}, \\quad X = \\frac{v_0^2\\sin 2\\theta}{g}, \\quad T = \\frac{2v_0\\sin\\theta}{g}$$
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>$\\theta = 45Â°$ æ—¶å°„ç¨‹æœ€å¤§: $X_{\\max} = \\frac{v_0^2}{g}$</li>
                    <li>ä¸Šå‡æ—¶é—´ = ä¸‹é™æ—¶é—´ = $\\frac{T}{2}$</li>
                    <li>è½åœ°é€Ÿåº¦å¤§å°ç­‰äºåˆé€Ÿåº¦: $v_{è½} = v_0$</li>
                    <li>äº’è¡¥è§’ $(\\theta$ å’Œ $90Â° - \\theta)$ å°„ç¨‹ç›¸ç­‰</li>
                    <li>è½¨è¿¹å…³äºæœ€é«˜ç‚¹å¯¹ç§°</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 'v0', label: 'åˆé€Ÿåº¦ vâ‚€ (m/s)', min: 10, max: 40, step: 2, value: 20, unit: 'm/s'},
            {id: 'angle', label: 'æŠ›å°„è§’ Î¸ (Â°)', min: 15, max: 75, step: 5, value: 45, unit: 'Â°'}
        ],
        diagramType: 'xy',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> è½¨è¿¹ä¸ºæŠ›ç‰©çº¿,å…³äºæœ€é«˜ç‚¹å¯¹ç§°ã€‚$\\theta=45Â°$ æ—¶å°„ç¨‹æœ€å¤§ã€‚äº’è¡¥è§’å°„ç¨‹ç›¸ç­‰ã€‚é€Ÿåº¦æ–¹å‘æ²¿åˆ‡çº¿,åœ¨æœ€é«˜ç‚¹æ°´å¹³ã€‚'
    },
    
    circular: {
        title: "åŒ€é€Ÿåœ†å‘¨è¿åŠ¨",
        theory: `
            <div class="theory-section">
                <h3>ğŸ“ è¿åŠ¨ç‰¹å¾</h3>
                <ul>
                    <li><strong>é€Ÿç‡:</strong> $v$ æ’å®š,ä½†é€Ÿåº¦æ–¹å‘æ—¶åˆ»æ”¹å˜</li>
                    <li><strong>åŠ é€Ÿåº¦:</strong> å‘å¿ƒåŠ é€Ÿåº¦ $a_n$,æ–¹å‘æŒ‡å‘åœ†å¿ƒ</li>
                    <li><strong>è¿åŠ¨æ€§è´¨:</strong> å˜é€Ÿæ›²çº¿è¿åŠ¨</li>
                    <li><strong>è½¨è¿¹:</strong> åœ†</li>
                </ul>
                
                <h3>ğŸ“ å…¬å¼</h3>
                <div class="formula-box">
                    $$v = \\frac{2\\pi r}{T} = \\omega r$$
                    $$\\omega = \\frac{2\\pi}{T} = 2\\pi f$$
                    $$a_n = \\frac{v^2}{r} = \\omega^2 r = \\frac{4\\pi^2 r}{T^2}$$
                    $$F_n = ma_n = \\frac{mv^2}{r} = m\\omega^2 r$$
                </div>
                
                <h3>ğŸ¯ é‡è¦æ¨è®º</h3>
                <ul>
                    <li>å‘å¿ƒåŠ›æ˜¯æ•ˆæœåŠ›,ç”±å®é™…åŠ›çš„åˆåŠ›æä¾›</li>
                    <li>åŒè½´è½¬åŠ¨: $\\omega$ ç›¸åŒ,$v \\propto r$, $a_n \\propto r$</li>
                    <li>çš®å¸¦ä¼ åŠ¨: $v$ ç›¸åŒ,$\\omega \\propto \\frac{1}{r}$, $a_n \\propto \\frac{1}{r}$</li>
                    <li>åŒ€é€Ÿåœ†å‘¨è¿åŠ¨ä¸æ˜¯åŒ€å˜é€Ÿè¿åŠ¨(åŠ é€Ÿåº¦æ–¹å‘å˜åŒ–)</li>
                    <li>ä¸´ç•Œé—®é¢˜: $F_n = F_{å‘å¿ƒåŠ›}$ (ç”±é‡åŠ›ã€å¼¹åŠ›ã€æ‘©æ“¦åŠ›ç­‰æä¾›)</li>
                </ul>
            </div>
        `,
        controls: [
            {id: 'r', label: 'åŠå¾„ r (m)', min: 1, max: 5, step: 0.5, value: 2, unit: 'm'},
            {id: 'T', label: 'å‘¨æœŸ T (s)', min: 0.5, max: 4, step: 0.5, value: 2, unit: 's'}
        ],
        diagramType: 'circular',
        diagramAnalysis: '<strong>å›¾åƒè§£æ:</strong> åœ†å½¢è½¨è¿¹,é€Ÿåº¦æ–¹å‘æ²¿åˆ‡çº¿ä¸æ–­å˜åŒ–,å‘å¿ƒåŠ é€Ÿåº¦å§‹ç»ˆæŒ‡å‘åœ†å¿ƒã€‚è™½ç„¶é€Ÿç‡æ’å®š,ä½†å› é€Ÿåº¦æ–¹å‘æ”¹å˜,å±äºå˜é€Ÿè¿åŠ¨ã€‚'
    }
};

// å…¨å±€å˜é‡
let currentMotion = 'uniform';
let animationId = null;

// ===== æ·»åŠ è¿™ä¸ªè¾…åŠ©å‡½æ•° =====
function renderMath(element) {
    if(window.MathJax && window.MathJax.typesetPromise) {
        const elements = element ? [element] : undefined;
        MathJax.typesetPromise(elements).catch((err) => {
            console.log('MathJax æ¸²æŸ“é”™è¯¯:', err);
        });
    } else {
        setTimeout(() => {
            if(window.MathJax && window.MathJax.typesetPromise) {
                const elements = element ? [element] : undefined;
                MathJax.typesetPromise(elements);
            }
        }, 500);
    }
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', () => {
    setupMotionButtons();
    loadMotion('uniform');
});

// è®¾ç½®è¿åŠ¨ç±»å‹æŒ‰é’®
function setupMotionButtons() {
    const buttons = document.querySelectorAll('.motion-btn');
    buttons.forEach(btn => {
        btn.addEventListener('click', () => {
            buttons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            loadMotion(btn.dataset.motion);
        });
    });
}

// åŠ è½½è¿åŠ¨ç±»å‹
function loadMotion(motionType) {
    currentMotion = motionType;
    const data = motionData[motionType];
    const contentArea = document.getElementById('content-area');
    
    let html = `
        ${data.theory}
        
        <div class="controls-section">
            <h3>âš™ï¸ å‚æ•°è°ƒèŠ‚</h3>
            ${data.controls.map(ctrl => `
                <div class="control-group">
                    <label for="${ctrl.id}">${ctrl.label}:</label>
                    <input type="range" id="${ctrl.id}" 
                           min="${ctrl.min}" max="${ctrl.max}" 
                           step="${ctrl.step}" value="${ctrl.value}">
                    <span id="${ctrl.id}-value">${ctrl.value.toFixed(1)} ${ctrl.unit}</span>
                </div>
            `).join('')}
            <button id="animate-button">ğŸ¬ å¼€å§‹æ¨¡æ‹Ÿ</button>
        </div>
        
        <div class="visualization-section">
            <div class="animation-box">
                <h3>ğŸ¨ è¿åŠ¨åŠ¨ç”»</h3>
                <canvas id="animation-canvas"></canvas>
            </div>
            <div class="diagram-box">
                <h3>ğŸ“Š åæ ‡ç³»è§£æå›¾</h3>
                <canvas id="diagram-canvas"></canvas>
                <div class="diagram-analysis">${data.diagramAnalysis}</div>
            </div>
        </div>
        
        <div class="info-panel">
            <strong>ğŸ“Š è®¡ç®—ç»“æœ:</strong> <span id="result-info">è°ƒæ•´å‚æ•°åç‚¹å‡»"å¼€å§‹æ¨¡æ‹Ÿ"æŸ¥çœ‹ç»“æœ</span>
        </div>
    `;
    
    contentArea.innerHTML = html;
    
    // é‡æ–°æ¸²æŸ“ MathJax
    renderMath(contentArea);
    
    // ç»‘å®šäº‹ä»¶
    data.controls.forEach(ctrl => {
        const slider = document.getElementById(ctrl.id);
        const valueDisplay = document.getElementById(`${ctrl.id}-value`);
        slider.addEventListener('input', (e) => {
            valueDisplay.textContent = `${parseFloat(e.target.value).toFixed(1)} ${ctrl.unit}`;
        });
    });
    
    document.getElementById('animate-button').addEventListener('click', runAnimation);
}

// è¿è¡ŒåŠ¨ç”»
function runAnimation() {
    const data = motionData[currentMotion];
    const params = {};
    
    data.controls.forEach(ctrl => {
        params[ctrl.id] = parseFloat(document.getElementById(ctrl.id).value);
    });
    
    // è®¡ç®—æ•°æ®
    let result = calculateMotionData(params);
    
    // æ›´æ–°ç»“æœä¿¡æ¯
    const resultInfo = document.getElementById('result-info');
    resultInfo.innerHTML = result.info;
    renderMath(resultInfo);
    
    // ç»˜åˆ¶åæ ‡ç³»è§£æå›¾
    drawDiagram(params, result);
    
    // å¯åŠ¨åŠ¨ç”»
    drawAnimation(params, result);
}

// è®¡ç®—è¿åŠ¨æ•°æ®
function calculateMotionData(params) {
    const motion = currentMotion;
    const g = 9.8;
    
    if(motion === 'uniform') {
        const {v0, t} = params;
        const finalS = v0 * t;
        return {
            info: `$t = ${t.toFixed(1)}$ s æ—¶,è·¯ç¨‹ $S = ${finalS.toFixed(2)}$ m`
        };
        
    } else if(motion === 'uniform-acc') {
        const {v0, a, t} = params;
        const vEnd = v0 + a * t;
        const S = v0 * t + 0.5 * a * t * t;
        return {
            info: `æœ«é€Ÿåº¦ $v = ${vEnd.toFixed(2)}$ m/s, è·¯ç¨‹ $S = ${S.toFixed(2)}$ m`
        };
        
    } else if(motion === 'uniform-dec') {
        const {v0, a, t} = params;
        const tStop = v0 / a;
        const actualT = Math.min(t, tStop);
        const S = v0 * actualT - 0.5 * a * actualT * actualT;
        const status = t > tStop ? `(å·²åœæ­¢,åœæ­¢æ—¶é—´ $= ${tStop.toFixed(2)}$ s)` : '';
        return {
            info: `è·¯ç¨‹ $S = ${S.toFixed(2)}$ m ${status}`
        };
        
    } else if(motion === 'freefall') {
        const {t} = params;
        const h = 0.5 * g * t * t;
        const v = g * t;
        return {
            info: `ä¸‹è½é«˜åº¦ $h = ${h.toFixed(2)}$ m, æœ«é€Ÿåº¦ $v = ${v.toFixed(2)}$ m/s`
        };
        
    } else if(motion === 'vertical-up') {
        const {v0, t} = params;
        const tPeak = v0 / g;
        const hMax = (v0 * v0) / (2 * g);
        return {
            info: `æœ€å¤§é«˜åº¦ $H = ${hMax.toFixed(2)}$ m, ä¸Šå‡æ—¶é—´ $= ${tPeak.toFixed(2)}$ s`
        };
        
    } else if(motion === 'horizontal') {
        const {v0, h} = params;
        const tFall = Math.sqrt(2 * h / g);
        const range = v0 * tFall;
        return {
            info: `é£è¡Œæ—¶é—´ $t = ${tFall.toFixed(2)}$ s, æ°´å¹³å°„ç¨‹ $X = ${range.toFixed(2)}$ m`
        };
        
    } else if(motion === 'projectile') {
        const {v0, angle} = params;
        const theta = (angle * Math.PI) / 180;
        const vy0 = v0 * Math.sin(theta);
        const tTotal = (2 * vy0) / g;
        const range = (v0 * v0 * Math.sin(2 * theta)) / g;
        const hMax = (vy0 * vy0) / (2 * g);
        return {
            info: `å°„ç¨‹ $X = ${range.toFixed(2)}$ m, å°„é«˜ $H = ${hMax.toFixed(2)}$ m, é£è¡Œæ—¶é—´ $= ${tTotal.toFixed(2)}$ s`
        };
        
    } else if(motion === 'circular') {
        const {r, T} = params;
        const omega = (2 * Math.PI) / T;
        const v = omega * r;
        const an = (v * v) / r;
        return {
            info: `çº¿é€Ÿåº¦ $v = ${v.toFixed(2)}$ m/s, è§’é€Ÿåº¦ $\\omega = ${omega.toFixed(2)}$ rad/s, å‘å¿ƒåŠ é€Ÿåº¦ $a_n = ${an.toFixed(2)}$ m/sÂ²`
        };
    }
}

// ç»˜åˆ¶åæ ‡ç³»è§£æå›¾
function drawDiagram(params, result) {
    const canvas = document.getElementById('diagram-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    const motion = currentMotion;
    const g = 9.8;
    
    // è®¾ç½®æ ·å¼
    ctx.strokeStyle = '#333';
    ctx.lineWidth = 2;
    ctx.font = '14px Arial';
    ctx.fillStyle = '#333';
    
    if(motion === 'uniform' || motion === 'uniform-acc' || motion === 'uniform-dec') {
        // S-t æˆ– v-t å›¾
        const marginLeft = 60;
        const marginBottom = 50;
        const marginTop = 30;
        const marginRight = 30;
        
        const plotWidth = canvas.width - marginLeft - marginRight;
        const plotHeight = canvas.height - marginTop - marginBottom;
        
        // ç»˜åˆ¶åæ ‡è½´
        ctx.beginPath();
        ctx.moveTo(marginLeft, marginTop);
        ctx.lineTo(marginLeft, canvas.height - marginBottom);
        ctx.lineTo(canvas.width - marginRight, canvas.height - marginBottom);
        ctx.stroke();
        
        // åæ ‡è½´ç®­å¤´
        ctx.beginPath();
        ctx.moveTo(canvas.width - marginRight, canvas.height - marginBottom);
        ctx.lineTo(canvas.width - marginRight - 8, canvas.height - marginBottom - 5);
        ctx.lineTo(canvas.width - marginRight - 8, canvas.height - marginBottom + 5);
        ctx.closePath();
        ctx.fill();
        
        ctx.beginPath();
        ctx.moveTo(marginLeft, marginTop);
        ctx.lineTo(marginLeft - 5, marginTop + 8);
        ctx.lineTo(marginLeft + 5, marginTop + 8);
        ctx.closePath();
        ctx.fill();
        
        // åæ ‡è½´æ ‡ç­¾
        ctx.font = 'bold 16px Arial';
        ctx.fillText('t (s)', canvas.width - marginRight + 5, canvas.height - marginBottom + 20);
        
        if(motion === 'uniform') {
            ctx.fillText('S (m)', marginLeft - 15, marginTop - 10);
            
            const {v0, t} = params;
            const maxT = t;
            const maxS = Math.abs(v0 * t);
            
            // ç»˜åˆ¶åˆ»åº¦
            for(let i = 0; i <= 5; i++) {
                const tVal = (i / 5) * maxT;
                const sVal = (i / 5) * maxS;
                
                const xPos = marginLeft + (i / 5) * plotWidth;
                const yPos = canvas.height - marginBottom - (i / 5) * plotHeight;
                
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.fillText(tVal.toFixed(1), xPos - 10, canvas.height - marginBottom + 20);
                ctx.fillText(sVal.toFixed(0), marginLeft - 40, yPos + 5);
            }
            
            // ç»˜åˆ¶ S-t ç›´çº¿
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(marginLeft, canvas.height - marginBottom);
            ctx.lineTo(canvas.width - marginRight, marginTop);
            ctx.stroke();
            
        } else {
            ctx.fillText('v (m/s)', marginLeft - 15, marginTop - 10);
            
            const {v0, a, t} = params;
            const realA = motion === 'uniform-dec' ? -a : a;
            const maxT = motion === 'uniform-dec' ? Math.min(t, v0 / a) : t;
            const vEnd = v0 + realA * maxT;
            const maxV = Math.max(Math.abs(v0), Math.abs(vEnd));
            
            // ç»˜åˆ¶åˆ»åº¦
            for(let i = 0; i <= 5; i++) {
                const tVal = (i / 5) * t;
                const vVal = (i / 5) * maxV;
                
                const xPos = marginLeft + (i / 5) * plotWidth;
                const yPos = canvas.height - marginBottom - (i / 5) * plotHeight;
                
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.fillText(tVal.toFixed(1), xPos - 10, canvas.height - marginBottom + 20);
                ctx.fillText(vVal.toFixed(1), marginLeft - 45, yPos + 5);
            }
            
            // ç»˜åˆ¶ v-t ç›´çº¿
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            const scaleT = plotWidth / t;
            const scaleV = plotHeight / maxV;
            
            for(let i = 0; i <= 100; i++) {
                const ti = (i / 100) * t;
                let vi;
                
                if(motion === 'uniform-dec' && ti > v0 / a) {
                    vi = 0;
                } else {
                    vi = v0 + realA * ti;
                }
                
                const x = marginLeft + ti * scaleT;
                const y = canvas.height - marginBottom - vi * scaleV;
                
                if(i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
        }
        
    } else if(motion === 'freefall' || motion === 'vertical-up') {
        // h-t å›¾
        const marginLeft = 60;
        const marginBottom = 50;
        const marginTop = 30;
        const marginRight = 30;
        
        const plotWidth = canvas.width - marginLeft - marginRight;
        const plotHeight = canvas.height - marginTop - marginBottom;
        
        // ç»˜åˆ¶åæ ‡è½´
        ctx.beginPath();
        ctx.moveTo(marginLeft, marginTop);
        ctx.lineTo(marginLeft, canvas.height - marginBottom);
        ctx.lineTo(canvas.width - marginRight, canvas.height - marginBottom);
        ctx.stroke();
        
        // ç®­å¤´
        ctx.beginPath();
        ctx.moveTo(canvas.width - marginRight, canvas.height - marginBottom);
        ctx.lineTo(canvas.width - marginRight - 8, canvas.height - marginBottom - 5);
        ctx.lineTo(canvas.width - marginRight - 8, canvas.height - marginBottom + 5);
        ctx.closePath();
        ctx.fill();
        
        ctx.beginPath();
        ctx.moveTo(marginLeft, marginTop);
        ctx.lineTo(marginLeft - 5, marginTop + 8);
        ctx.lineTo(marginLeft + 5, marginTop + 8);
        ctx.closePath();
        ctx.fill();
        
        // æ ‡ç­¾
        ctx.font = 'bold 16px Arial';
        ctx.fillText('t (s)', canvas.width - marginRight + 5, canvas.height - marginBottom + 20);
        ctx.fillText('h (m)', marginLeft - 15, marginTop - 10);
        
        let maxT, maxH;
        if(motion === 'freefall') {
            const {t} = params;
            maxT = t;
            maxH = 0.5 * g * t * t;
        } else {
            const {v0, t} = params;
            maxT = t;
            maxH = (v0 * v0) / (2 * g);
        }
        
        // åˆ»åº¦
        for(let i = 0; i <= 5; i++) {
            const tVal = (i / 5) * maxT;
            const hVal = (i / 5) * maxH;
            
            const xPos = marginLeft + (i / 5) * plotWidth;
            const yPos = canvas.height - marginBottom - (i / 5) * plotHeight;
            
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.fillText(tVal.toFixed(1), xPos - 10, canvas.height - marginBottom + 20);
            ctx.fillText(hVal.toFixed(0), marginLeft - 40, yPos + 5);
        }
        
        // ç»˜åˆ¶æŠ›ç‰©çº¿
        ctx.strokeStyle = '#667eea';
        ctx.lineWidth = 3;
        ctx.beginPath();
        
        const scaleT = plotWidth / maxT;
        const scaleH = plotHeight / maxH;
        
        for(let i = 0; i <= 100; i++) {
            const ti = (i / 100) * maxT;
            let hi;
            
            if(motion === 'freefall') {
                hi = 0.5 * g * ti * ti;
            } else {
                const {v0} = params;
                hi = v0 * ti - 0.5 * g * ti * ti;
                if(hi < 0) hi = 0;
            }
            
            const x = marginLeft + ti * scaleT;
            const y = canvas.height - marginBottom - hi * scaleH;
            
            if(i === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.stroke();
        
    } else if(motion === 'horizontal' || motion === 'projectile') {
        // x-y è½¨è¿¹å›¾
        const marginLeft = 60;
        const marginBottom = 50;
        const marginTop = 30;
        const marginRight = 30;
        
        const plotWidth = canvas.width - marginLeft - marginRight;
        const plotHeight = canvas.height - marginTop - marginBottom;
        
        // åæ ‡è½´
        ctx.beginPath();
        ctx.moveTo(marginLeft, canvas.height - marginBottom);
        ctx.lineTo(canvas.width - marginRight, canvas.height - marginBottom);
        ctx.moveTo(marginLeft, canvas.height - marginBottom);
        ctx.lineTo(marginLeft, marginTop);
        ctx.stroke();
        
        // ç®­å¤´
        ctx.beginPath();
        ctx.moveTo(canvas.width - marginRight, canvas.height - marginBottom);
        ctx.lineTo(canvas.width - marginRight - 8, canvas.height - marginBottom - 5);
        ctx.lineTo(canvas.width - marginRight - 8, canvas.height - marginBottom + 5);
        ctx.closePath();
        ctx.fill();
        
        ctx.beginPath();
        ctx.moveTo(marginLeft, marginTop);
        ctx.lineTo(marginLeft - 5, marginTop + 8);
        ctx.lineTo(marginLeft + 5, marginTop + 8);
        ctx.closePath();
        ctx.fill();
        
        // æ ‡ç­¾
        ctx.font = 'bold 16px Arial';
        ctx.fillText('x (m)', canvas.width - marginRight + 5, canvas.height - marginBottom + 20);
        ctx.fillText('y (m)', marginLeft - 15, marginTop - 10);
        
        let maxX, maxY;
        
        if(motion === 'horizontal') {
            const {v0, h} = params;
            const tFall = Math.sqrt(2 * h / g);
            maxX = v0 * tFall;
            maxY = h;
        } else {
            const {v0, angle} = params;
            const theta = (angle * Math.PI) / 180;
            const vx = v0 * Math.cos(theta);
            const vy0 = v0 * Math.sin(theta);
            maxX = (v0 * v0 * Math.sin(2 * theta)) / g;
            maxY = (vy0 * vy0) / (2 * g);
        }
        
        // åˆ»åº¦
        for(let i = 0; i <= 5; i++) {
            const xVal = (i / 5) * maxX;
            const yVal = (i / 5) * maxY;
            
            const xPos = marginLeft + (i / 5) * plotWidth;
            const yPos = canvas.height - marginBottom - (i / 5) * plotHeight;
            
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.fillText(xVal.toFixed(0), xPos - 10, canvas.height - marginBottom + 20);
            ctx.fillText(yVal.toFixed(0), marginLeft - 40, yPos + 5);
        }
        
        // ç»˜åˆ¶æŠ›ç‰©çº¿è½¨è¿¹
        ctx.strokeStyle = '#667eea';
        ctx.lineWidth = 3;
        ctx.beginPath();
        
        const scaleX = plotWidth / maxX;
        const scaleY = plotHeight / maxY;
        
        if(motion === 'horizontal') {
            const {v0, h} = params;
            const tFall = Math.sqrt(2 * h / g);
            
            for(let i = 0; i <= 100; i++) {
                const ti = (i / 100) * tFall;
                const xi = v0 * ti;
                const yi = h - 0.5 * g * ti * ti;
                
                const x = marginLeft + xi * scaleX;
                const y = canvas.height - marginBottom - yi * scaleY;
                
                if(i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
        } else {
            const {v0, angle} = params;
            const theta = (angle * Math.PI) / 180;
            const vx = v0 * Math.cos(theta);
            const vy0 = v0 * Math.sin(theta);
            const tTotal = (2 * vy0) / g;
            
            for(let i = 0; i <= 100; i++) {
                const ti = (i / 100) * tTotal;
                const xi = vx * ti;
                const yi = vy0 * ti - 0.5 * g * ti * ti;
                
                if(yi < 0) continue;
                
                const x = marginLeft + xi * scaleX;
                const y = canvas.height - marginBottom - yi * scaleY;
                
                if(i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
        }
        ctx.stroke();
        
    } else if(motion === 'circular') {
        // åœ†å‘¨è¿åŠ¨è½¨è¿¹
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const {r} = params;
        const radius = Math.min(canvas.width, canvas.height) * 0.3;
        
        // ç»˜åˆ¶åæ ‡è½´
        ctx.strokeStyle = '#ccc';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(0, centerY);
        ctx.lineTo(canvas.width, centerY);
        ctx.moveTo(centerX, 0);
        ctx.lineTo(centerX, canvas.height);
        ctx.stroke();
        
        // ç»˜åˆ¶åœ†
        ctx.strokeStyle = '#667eea';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        ctx.stroke();
        
        // ç»˜åˆ¶åŠå¾„
        ctx.strokeStyle = '#999';
        ctx.lineWidth = 2;
        ctx.setLineDash([5, 5]);
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.lineTo(centerX + radius, centerY);
        ctx.stroke();
        ctx.setLineDash([]);
        
        // æ ‡æ³¨
        ctx.fillStyle = '#333';
        ctx.font = 'bold 14px Arial';
        ctx.fillText('r', centerX + radius / 2 - 5, centerY - 10);
        
        // æ ‡æ³¨ä¸€ä¸ªè´¨ç‚¹ä½ç½®
        const angle = Math.PI / 4;
        const px = centerX + radius * Math.cos(angle);
        const py = centerY + radius * Math.sin(angle);
        
        ctx.beginPath();
        ctx.arc(px, py, 6, 0, 2 * Math.PI);
        ctx.fillStyle = '#ff6b6b';
        ctx.fill();
        
        // ç»˜åˆ¶é€Ÿåº¦å‘é‡(åˆ‡çº¿æ–¹å‘)
        const vx = -Math.sin(angle) * 40;
        const vy = Math.cos(angle) * 40;
        drawArrow(ctx, px, py, px + vx, py + vy, '#4ecdc4');
        ctx.fillStyle = '#4ecdc4';
        ctx.font = 'bold 12px Arial';
        ctx.fillText('v', px + vx + 10, py + vy - 5);
        
        // ç»˜åˆ¶å‘å¿ƒåŠ é€Ÿåº¦(æŒ‡å‘åœ†å¿ƒ)
        const ax = -Math.cos(angle) * 35;
        const ay = -Math.sin(angle) * 35;
        drawArrow(ctx, px, py, px + ax, py + ay, '#ffe66d');
        ctx.fillStyle = '#ffe66d';
        ctx.fillText('aâ‚™', px + ax - 20, py + ay);
    }
}

// ç»˜åˆ¶è¿åŠ¨åŠ¨ç”»
function drawAnimation(params, result) {
    const canvas = document.getElementById('animation-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    
    if(animationId) cancelAnimationFrame(animationId);
    
    const motion = currentMotion;
    
    if(motion === 'circular') {
        animateCircular(ctx, canvas, params);
    } else if(motion === 'horizontal' || motion === 'projectile') {
        animateProjectile(ctx, canvas, params);
    } else if(motion === 'freefall' || motion === 'vertical-up') {
        animateVertical(ctx, canvas, params);
    } else {
        animateHorizontal(ctx, canvas, params);
    }
}

// åœ†å‘¨è¿åŠ¨åŠ¨ç”»
function animateCircular(ctx, canvas, params) {
    const {r, T} = params;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = Math.min(canvas.width, canvas.height) * 0.35;
    let angle = 0;
    
    const animate = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // åæ ‡è½´
        ctx.strokeStyle = '#ccc';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(0, centerY);
        ctx.lineTo(canvas.width, centerY);
        ctx.moveTo(centerX, 0);
        ctx.lineTo(centerX, canvas.height);
        ctx.stroke();
        
        // è½¨é“
        ctx.strokeStyle = '#ddd';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
        ctx.stroke();
        
        // åœ†å¿ƒ
        ctx.beginPath();
        ctx.arc(centerX, centerY, 4, 0, 2 * Math.PI);
        ctx.fillStyle = '#667eea';
        ctx.fill();
        
        // ç‰©ä½“ä½ç½®
        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);
        
        // ç‰©ä½“
        ctx.beginPath();
        ctx.arc(x, y, 10, 0, 2 * Math.PI);
        ctx.fillStyle = '#ff6b6b';
        ctx.fill();
        
        // é€Ÿåº¦å‘é‡
        const vx = -Math.sin(angle) * 35;
        const vy = Math.cos(angle) * 35;
        drawArrow(ctx, x, y, x + vx, y + vy, '#4ecdc4');
        
        // å‘å¿ƒåŠ é€Ÿåº¦
        const ax = -Math.cos(angle) * 30;
        const ay = -Math.sin(angle) * 30;
        drawArrow(ctx, x, y, x + ax, y + ay, '#ffe66d');
        
        angle += (2 * Math.PI) / (T * 60);
        animationId = requestAnimationFrame(animate);
    };
    
    animate();
}

// æŠ›ä½“è¿åŠ¨åŠ¨ç”»
function animateProjectile(ctx, canvas, params) {
    const motion = currentMotion;
    const g = 9.8;
    let t = 0;
    let maxT, vx, vy0, h0 = 0;
    
    if(motion === 'horizontal') {
        const {v0, h} = params;
        maxT = Math.sqrt(2 * h / g);
        vx = v0;
        vy0 = 0;
        h0 = h;
    } else {
        const {v0, angle} = params;
        const theta = (angle * Math.PI) / 180;
        vx = v0 * Math.cos(theta);
        vy0 = v0 * Math.sin(theta);
        maxT = (2 * vy0) / g;
    }
    
    const maxX = vx * maxT;
    const maxY = h0 + (vy0 * vy0) / (2 * g);
    const scale = Math.min((canvas.width - 60) / maxX, (canvas.height - 60) / maxY) * 0.8;
    
    const animate = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // åæ ‡è½´
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(30, canvas.height - 30);
        ctx.lineTo(canvas.width - 10, canvas.height - 30);
        ctx.moveTo(30, canvas.height - 30);
        ctx.lineTo(30, 10);
        ctx.stroke();
        
        // ç®­å¤´
        drawAxisArrow(ctx, canvas.width - 10, canvas.height - 30, 'x');
        drawAxisArrow(ctx, 30, 10, 'y');
        
        // åˆ»åº¦
        for(let i = 0; i <= 5; i++) {
            const xPos = 30 + (i / 5) * (canvas.width - 50);
            const yPos = canvas.height - 30 - (i / 5) * (canvas.height - 50);
            
            ctx.fillStyle = '#666';
            ctx.font = '11px monospace';
            ctx.fillText((i / 5 * maxX).toFixed(0), xPos - 10, canvas.height - 15);
            ctx.fillText((i / 5 * maxY).toFixed(0), 5, yPos + 4);
        }
        
        // è®¡ç®—å½“å‰ä½ç½®
        const x = vx * t;
        const y = h0 + vy0 * t - 0.5 * g * t * t;
        
        if(y < 0 || t > maxT) {
            t = 0;
        }
        
        const canvasX = 30 + x * scale;
        const canvasY = canvas.height - 30 - y * scale;
        
        // ç»˜åˆ¶è½¨è¿¹
        ctx.strokeStyle = 'rgba(102, 126, 234, 0.4)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        for(let i = 0; i <= t * 60; i++) {
            const ti = i / 60;
            const xi = vx * ti;
            const yi = h0 + vy0 * ti - 0.5 * g * ti * ti;
            const cxi = 30 + xi * scale;
            const cyi = canvas.height - 30 - yi * scale;
            if(i === 0) ctx.moveTo(cxi, cyi);
            else ctx.lineTo(cxi, cyi);
        }
        ctx.stroke();
        
        // ç»˜åˆ¶ç‰©ä½“
        ctx.beginPath();
        ctx.arc(canvasX, canvasY, 12, 0, 2 * Math.PI);
        ctx.fillStyle = '#ff6b6b';
        ctx.fill();
        
        // é€Ÿåº¦å‘é‡
        const v_x = vx * scale / 5;
        const v_y = (vy0 - g * t) * scale / 5;
        drawArrow(ctx, canvasX, canvasY, canvasX + v_x, canvasY - v_y, '#4ecdc4');
        
        t += 0.02;
        animationId = requestAnimationFrame(animate);
    };
    
    animate();
}

// ç«–ç›´è¿åŠ¨åŠ¨ç”»
function animateVertical(ctx, canvas, params) {
    const motion = currentMotion;
    const g = 9.8;
    let t = 0;
    let maxT, v0;
    
    if(motion === 'freefall') {
        maxT = params.t;
        v0 = 0;
    } else {
        v0 = params.v0;
        maxT = params.t;
    }
    
    const maxH = motion === 'freefall' ? 0.5 * g * maxT * maxT : (v0 * v0) / (2 * g) * 1.2;
    const scale = (canvas.height - 60) / maxH;
    
    const animate = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // åæ ‡è½´
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(canvas.width / 2, canvas.height - 20);
        ctx.lineTo(canvas.width / 2, 10);
        ctx.stroke();
        
        drawAxisArrow(ctx, canvas.width / 2, 10, 'h');
        
        // åˆ»åº¦
        for(let i = 0; i <= 5; i++) {
            const h = (i / 5) * maxH;
            const yPos = canvas.height - 20 - h * scale;
            
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2 - 5, yPos);
            ctx.lineTo(canvas.width / 2 + 5, yPos);
            ctx.strokeStyle = '#999';
            ctx.stroke();
            
            ctx.fillStyle = '#666';
            ctx.font = '11px monospace';
            ctx.fillText(h.toFixed(1), canvas.width / 2 + 10, yPos + 4);
        }
        
        // è®¡ç®—é«˜åº¦
        let h;
        if(motion === 'freefall') {
            h = 0.5 * g * t * t;
        } else {
            h = v0 * t - 0.5 * g * t * t;
            if(h < 0) h = 0;
        }
        
        if(t > maxT) t = 0;
        
        const canvasY = canvas.height - 20 - h * scale;
        
        // ç»˜åˆ¶ç‰©ä½“
        ctx.beginPath();
        ctx.arc(canvas.width / 2, canvasY, 12, 0, 2 * Math.PI);
        ctx.fillStyle = '#ff6b6b';
        ctx.fill();
        
        // é€Ÿåº¦å‘é‡
        const v = motion === 'freefall' ? g * t : v0 - g * t;
        const arrowLen = Math.abs(v) * scale / 8;
        const direction = motion === 'freefall' ? 1 : (v >= 0 ? -1 : 1);
        drawArrow(ctx, canvas.width / 2, canvasY, canvas.width / 2, canvasY + direction * arrowLen, '#4ecdc4');
        
        t += 0.02;
        animationId = requestAnimationFrame(animate);
    };
    
    animate();
}

// æ°´å¹³è¿åŠ¨åŠ¨ç”»
function animateHorizontal(ctx, canvas, params) {
    const motion = currentMotion;
    let t = 0;
    let maxT, v0, a = 0;
    
    if(motion === 'uniform') {
        v0 = params.v0;
        maxT = params.t;
    } else if(motion === 'uniform-acc') {
        v0 = params.v0;
        a = params.a;
        maxT = params.t;
    } else {
        v0 = params.v0;
        a = -params.a;
        maxT = Math.min(params.t, v0 / params.a);
    }
    
    const maxS = Math.abs(v0 * maxT + 0.5 * a * maxT * maxT);
    const scale = (canvas.width - 80) / (maxS || 50);
    
    const animate = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // åæ ‡è½´
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(40, canvas.height / 2);
        ctx.lineTo(canvas.width - 10, canvas.height / 2);
        ctx.stroke();
        
        drawAxisArrow(ctx, canvas.width - 10, canvas.height / 2, 'S');
        
        // åˆ»åº¦
        for(let i = 0; i <= 5; i++) {
            const s = (i / 5) * maxS;
            const xPos = 40 + (i / 5) * (canvas.width - 60);
            
            ctx.beginPath();
            ctx.moveTo(xPos, canvas.height / 2 - 5);
            ctx.lineTo(xPos, canvas.height / 2 + 5);
            ctx.strokeStyle = '#999';
            ctx.stroke();
            
            ctx.fillStyle = '#666';
            ctx.font = '11px Arial';
            ctx.fillText(s.toFixed(0), xPos - 10, canvas.height / 2 + 20);
        }
        
        // è®¡ç®—ä½ç½®
        const s = v0 * t + 0.5 * a * t * t;
        
        if(t > maxT) t = 0;
        
        const canvasX = 40 + (s / (maxS || 1)) * (canvas.width - 60);
        
        // ç»˜åˆ¶ç‰©ä½“
        ctx.beginPath();
        ctx.rect(canvasX - 15, canvas.height / 2 - 15, 30, 30);
        ctx.fillStyle = '#ff6b6b';
        ctx.fill();
        
        // é€Ÿåº¦æ ‡ç­¾
        const v = v0 + a * t;
        ctx.fillStyle = '#333';
        ctx.font = 'bold 13px monospace';
        ctx.fillText(`v = ${v.toFixed(1)} m/s`, canvasX - 40, canvas.height / 2 - 25);
        
        t += 0.03;
        animationId = requestAnimationFrame(animate);
    };
    
    animate();
}

// ç»˜åˆ¶ç®­å¤´è¾…åŠ©å‡½æ•°
function drawArrow(ctx, x1, y1, x2, y2, color) {
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.strokeStyle = color;
    ctx.lineWidth = 3;
    ctx.stroke();
    
    const angle = Math.atan2(y2 - y1, x2 - x1);
    ctx.beginPath();
    ctx.moveTo(x2, y2);
    ctx.lineTo(x2 - 10 * Math.cos(angle - Math.PI / 6), y2 - 10 * Math.sin(angle - Math.PI / 6));
    ctx.lineTo(x2 - 10 * Math.cos(angle + Math.PI / 6), y2 - 10 * Math.sin(angle + Math.PI / 6));
    ctx.closePath();
    ctx.fillStyle = color;
    ctx.fill();
}

// ç»˜åˆ¶åæ ‡è½´ç®­å¤´
function drawAxisArrow(ctx, x, y, label) {
    if(label === 'x' || label === 'S') {
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(x - 8, y - 5);
        ctx.lineTo(x - 8, y + 5);
        ctx.closePath();
    } else {
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(x - 5, y + 8);
        ctx.lineTo(x + 5, y + 8);
        ctx.closePath();
    }
    ctx.fillStyle = '#333';
    ctx.fill();
    
    ctx.fillStyle = '#333';
    ctx.font = 'bold 14px Arial';
    if(label === 'x' || label === 'S') {
        ctx.fillText(label, x + 5, y + 15);
    } else {
        ctx.fillText(label, x + 10, y + 5);
    }
}
</script>

</body>
</html>


